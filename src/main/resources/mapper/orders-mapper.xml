<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
         "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Orders">

    <!-- 1. 주문 생성 -->
    <insert id="insert" parameterType="orders">
        INSERT INTO orders (custid, bookid, saleprice, orderdate)
        VALUES (#{custid}, #{bookid}, #{saleprice}, #{orderdate})
    </insert>

    <!-- 2. 주문 목록 상세 조회 (JOIN) -->
    <select id="getAllWithDetails" resultType="OrderDetailsDTO">
        SELECT o.orderid, o.saleprice, o.orderdate,
               c.name AS customerName,
               b.bookname AS bookName
          FROM orders o
          JOIN customer c ON o.custid = c.custid
          JOIN book b ON o.bookid = b.bookid
      ORDER BY o.orderdate DESC, o.orderid DESC
    </select>

</mapper>